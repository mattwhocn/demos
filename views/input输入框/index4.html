
<!DOCTYPE HTML>
<html >
<head>
<base href="<%=basePath%>" />

<meta content="text/html; charset=utf-8" />

<title>协议</title>
<style type="text/css">
		#upload_lable_a,#upload_lable_b,#upload_lable_c,#upload_lable_d{
			width: 80px;
			height: 80px;
			overflow: hidden;
			display: inline-block;
			border: 1px dashed #999;
			background: url(img/camera.png) no-repeat center center;
			/*ie7下写center center会偏移 */
			background-position:center left;
			position: relative;
		}
		#imageFile,#identityFile,#idCardPositiveFile,#idCardNegativeFile{
			width: 0px;
			height: 0px;
			position: absolute;
			outline: none;
			margin-top: -9999px;
		}
		.imgshow{
			position: absolute;left: 0;top: 0;
			width: 80px;
			height: 80px;
		}
	</style>


<link href="themes/default/style.css" rel="stylesheet" type="text/css" media="screen" />
<link href="themes/css/core.css" rel="stylesheet" type="text/css" media="screen" />
<link href="themes/css/print.css" rel="stylesheet" type="text/css"media="print" />
<link href="themes/css/uploadimg.css" rel="stylesheet" type="text/css" />
<script src="js/speedup.js" type="text/javascript"></script>
<script src="../newwwwww/uploadfile/js/jquery-1.7.1.js" type="text/javascript"></script>
<script src="js/jquery.cookie.js" type="text/javascript"></script>
<script src="js/jquery.validate.js" type="text/javascript"></script>
<script src="js/jquery.bgiframe.js" type="text/javascript"></script>
<script src="js/dwz.validate.method.js" type="text/javascript"></script>
<script src="js/dwz.regional.zh.js" type="text/javascript"></script>
<script src="js/dwz.ajax.js" type="text/javascript"></script>
<script src="js/CityJson.js" type="text/javascript"></script>
<script src="js/ProJson.js" type="text/javascript"></script>
<script src="js/DistrictJson.js" type="text/javascript"></script>
<script src="js/jquery.form.js" type="text/javascript"></script>
    <script type="text/javascript">
    $(function () {

        $.each(province, function (k, p) { 
            var option = "<option value='" + p.id + "'>" + p.name + "</option>";
            $("#province").append(option);
        });
         
        $("#province").change(function () {
            var selValue = $(this).val(); 
            $("#city option:gt(0)").remove();
             
            $.each(city, function (k, p) { 
                if (p.parentId == selValue) {
                    var option = "<option value='" + p.id + "'>" + p.name + "</option>";
                    $("#city").append(option);
                }
            });
             
        });
         
        $("#city").change(function () {
            var selValue = $(this).val();
            $("#county option:gt(0)").remove(); 

            $.each(District, function (k, p) {
                if (p.parentId == selValue) {
                    var option = "<option value='" + p.id + "'>" + p.name + "</option>";
                    $("#county").append(option);
                }
            }); 
        }); 
        
       
        
    });
    
    
    
    
    </script>

</head>
<body scroll="no">
	<div id="layout">
		<div id="header">
			<div class="headerNav">
				<a class="logo" href="#"></a>
			</div>
		</div>
	</div>
	<div class="pageContent">

		<form method="post" action="teacher/teacher/addOrganization.do" id="orgAdd"
			class="pageForm required-validate"
			onsubmit="return validateCallback(this, navTabAjaxDone);">
			<input type="hidden" name="orgAttribute"value="${param.orgAttribute}" />
			<input type="hidden" name="teacherName" value="${param.teacherName}" />
			<input type="hidden" name="teacherPassword"value="${param.teacherPassword}" />
			<input type="hidden" name="teacherPhoneNum"value="${param.teacherPhoneNum}" />
			<p style="font-size: 12px;float:left;text-indent:20px;" >欢迎成为班集合作机构！请务必填写真实信息，以便为您提供服务。</p>
			
			<table width="100%" style="font-size:14px;margin-top:-20px;">
				<tr>
					<td	style="font-size: 16px; text-align: center;height:30px;" colspan="2"><B>协议</B>>注册>完善信息>注册成功</td>
				</tr>
				<tr	style="border-spacing: 0px 25px;">
					<td width="40%" align="right" style="padding-right:15px;font-size:15px;">机构名称: </td>
					<td width="60%" align="left"><input type="text" class="required" name="organizationName" size="30" style="height:20px;"/></td>
				</tr>
				
				<tr style="display:none;height: 30px;  text-align: center; border-spacing: 0px 25px;"> 
					<td width="40%" align="right" style="padding-right:15px;"></td>
					<td width="60%" align="left">
						<label><input type="radio" name="orgAttribute" class="required" value="1" checked="checked"/>文化类</label> 
						<label><input type="radio" name="orgAttribute" class="required" value="2"/>素质类</label>
					</td>
			   </tr>
				<tr	style="height: 32px; text-align: center;">
					<td align="right" style="padding-right:15px; font-size:15px;">咨询电话: </td>
					<td align="left"><input type="text" name="organizationTel" class="required phone textInput" size="30" style="height:20px;"/></td>
				</tr>
				<tr style="height: 32px; text-align: center;">
					<td align="right" style="padding-right:15px; font-size:15px;">所在地区:</td>	
					<td align="left">
						<select id="province" name="province" style="width: 70px;height:23px;" class="required">
				        	<option value="">请选择</option>
				   		</select>
				    	<select id="city" name="city" style="width: 70px;height:21px;" class="required">
				        	<option value="">请选择</option>
				    	</select>
					    <select id="county" name="county" style="width: 70px; height:21px;">
					        <option value="">请选择</option>
					    </select>
					</td>
				</tr>
				<tr	style="height: 32px; text-align: center;">
					<td align="right" style="padding-right:15px; font-size:15px;">详细地址: </td>
					<td align="left">
						<input type="text" name="organizationAddress" class="required"size="30" style="height:20px;"/>
					</td>
				</tr>
				<tr	style="height: 32px; text-align: center;">
					<td align="right" style="padding-right:15px; font-size:15px;">机构简介:</td>
					<td align="left"> 
						<textarea name="organizationDescription" cols="33" rows="3" style="resize:none;"></textarea>
					</td>
				</tr>
				<tr	style="height: 32px; text-align: center;">
					<td align="right" style="padding-right:15px; font-size:15px;">机构LOGO: </td>
					<td align="left">
				        <input type="hidden" id="organizationLogoUrl" name="organizationLogoUrl" />
						<input type="hidden" name="saveUrlCode" value="3"/>
						<label class=" upload_wrap_a" id="upload_lable_a" for="imageFile">
							<input id="imageFile" type="file" onchange="uploadPic(this)" name="imageFile" />
						</label>
						<div style="color: #fe904e" id="picWarn">请上传40KB(80*80像素)的图片</div>
					</td>
				</tr>
				
				
			    <!--选择-->
				<tr style="height: 32px; text-align: center;"> 
					<td align="right" style="padding-right:15px; font-size:15px;">证件上传:</td>
					<td align="left">
						<div >
							<label><input type="radio" name="identityType" class="required upload_option" value="0" checked="checked"/>营业执照</label> 
							<label><input type="radio" name="identityType" class="required upload_option" value="1" />法人身份证</label>
					   </div>
					</td>
			    </tr>
			    
			    
			    <!--点击营业执照显示的部分-->
				<tr	style="height: 32px; text-align: center;" class="identityCard replace_item">
					<td align="right" style="padding-right:15px; font-size:15px;">机构证件: </td>
					<td align="left">
					    <input type="hidden" id="identity" name="identity" />
					    <label class=" upload_wrap_b" id="upload_lable_b" for="identityFile">
							<input id="identityFile" type="file" onchange="uploadIdentityPic(this)" name="identityFile" />
							<img src="" alt="" />
					    </label>
					    <div style="color: #fe904e;font-size:12px; height:20px;line-height:20px;" id="picIdentityWarn">请上传40KB(80*80像素)的图片</div>
					</td>
				</tr>
				
				<tr	style="height: 32px; text-align: center;" class="identityCard replace_item">
					<td align="right" style="padding-right:15px; font-size:15px;">公司名称:</td>
					<td align="left">
						<input id="companyName" type="text"  name="companyName" size="30" style="height:20px;"/>
					</td>
				</tr>
				
				
				<!--点击法人身份证显示的部分-->
				<tr	style="height: 32px; display:none; text-align: center;" class="idCard replace_item">
					<td align="right" style="padding-right:15px; font-size:15px;">法人身份证: </td>
					<td align="left">
					    <!-- 正面 -->
					    <input type="hidden" id="idCardPositive" name="idCardPositive" />
					    <label class=" upload_wrap_c" id="upload_lable_c" for="idCardPositiveFile">
							<input id="idCardPositiveFile" type="file" onchange="uploadIdCardPositivePic(this)" name="idCardPositiveFile" />
							<img src="" alt="" />
					    </label>
						
					    <!-- 反面 -->
					    <input type="hidden" id="idCardNegative" name="idCardNegative" />
					    <label class=" upload_wrap_d" id="upload_lable_d" for="idCardNegativeFile">
							<input id="idCardNegativeFile" type="file" onchange="uploadIdCardNegativePic(this)" name="idCardNegativeFile" />
						</label>
						<div style="color: #fe904e;font-size:12px; height:20px;line-height:20px;" id="idCardNegativeWarn">请上传40KB(80*80像素)的图片</div>
					  
					</td>
				</tr>
				
                <tr style="height: 32px; display:none; text-align: center;" class="idCard replace_item">
					<td align="right" style="padding-right:15px; font-size:15px;">法人姓名:</td>
					<td align="left">
						<input id="legalName" type="text"  name="legalName" size="30" style="height:20px;"/>
					</td>
				</tr> 
				 
				<tr style="height: 32px; text-align: center;">
					<td colspan="2" style="padding-right:20px;">
						<label><input type="button" value="上一步" onclick="history.go(-1)"  style="margin: 0 10px"/></label> 
						<label><input type="submit" value="下一步" style="margin:0 10px"/></label>
					</td>
				</tr>

			</table>
		</form>

	</div>
 <script type="text/javascript">
         //证件上传的radio点击事件
		$(function(){
		 		
				$('.upload_option').on('click',function(){
					$('.replace_item').css('display','none');
					var choseIndex = $(this).attr('value');
					if(choseIndex == 0){
						$('.identityCard').css('display','');
					}else{
						
						$('.idCard').css('display','');
					}
					
				})
		})
        //上传LOGO图片
    	function uploadPic(file) {
    		alert("11111");
    		/* var f = document.getElementById("imageFile").files;  
    		var file_size =f[0].size;
    		var size = file_size / 1024;
    		if (size > 40) {
    			alert("上传的文件大小不能超过40KB！");
    			return false;
    		} */
    		
			//主流浏览器
			if(file.files && file.files[0]){
				alert("22222");
				var imgObj = $('<img class="imgshow" />');
				$('.upload_wrap_a').append(imgObj);
				var reader = new FileReader();
				reader.onload = function(evt){
					imgObj.attr('src',evt.target.result);
				}
				reader.readAsDataURL(file.files[0]);
			}
//			else{
//				//ie浏览器
//				alert("333333");
//				file.select();
//				file.blur();
//				alert("44444");
//				var src = document.selection.createRange().text;
//				alert(src);
//				alert("55555");
//				
//				var sFilter='progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src=\'' + src + '\')';
//				var divObj = $('<div class="imgshow"></div>');
//				divObj.css('filter',sFilter);
//				$('.upload_wrap_a').append(divObj); 
//			}
    		
    		var filepath = $("input[name='imageFile']").val();
    		 
    		var extStart = filepath.lastIndexOf(".");
    		var ext = filepath.substring(extStart, filepath.length).toUpperCase();
    		if (ext != ".BMP" && ext != ".PNG" && ext != ".GIF" && ext != ".JPG"
    				&& ext != ".JPEG") {
    			alert("图片限于bmp,png,gif,jpeg,jpg格式");
    			return false;
    		}

    	

    		var options = {
    			url : "<%=basePath%>fileService/pic.do",
    			type : "post",
    			dataType : "json",
    			success : function(data) {
    				
    				$("#allUrl").attr("src", data.pic);//回显全路径
    				$("#organizationLogoUrl").val(data.pic);//此处是把啊里全路径保存进实体对应URL
    				$("#picWarn").hide();
    			}
    		}
    		//异步上传
    		$("#orgAdd").ajaxSubmit(options);
    	}  
        
    	//上传机构证件照图片
    	function uploadIdentityPic(file) {
    		
    		/* var f = document.getElementById("imageFile").files;  
    		var file_size =f[0].size;
    		var size = file_size / 1024;
    		if (size > 40) {
    			alert("上传的文件大小不能超过40KB！");
    			return false;
    		} */
    		
    		
    		
    		//主流浏览器
			if(file.files && file.files[0]){
				var imgObj = $('<img class="imgshow" />');
				$('.upload_wrap_b').append(imgObj);
				var reader = new FileReader();
				console.log(reader);
				reader.onload = function(evt){
					imgObj.attr('src',evt.target.result);
				}
				reader.readAsDataURL(file.files[0]);
			}else{
				//ie浏览器
				file.select();
				file.blur();
				var src = document.selection.createRange().text;
				console.log(src);
				var sFilter='progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src=\'' + src + '\')';
				var divObj = $('<div class="imgshow"></div>');
				divObj.css('filter',sFilter);
				$('.upload_wrap_b').append(divObj); 
			}
    		
    		
    		
    		var filepath = $("input[name='identityFile']").val();
    		var extStart = filepath.lastIndexOf(".");
    		var ext = filepath.substring(extStart, filepath.length).toUpperCase();
    		if (ext != ".BMP" && ext != ".PNG" && ext != ".GIF" && ext != ".JPG"
    				&& ext != ".JPEG") {
    			alert("图片限于bmp,png,gif,jpeg,jpg格式");
    			return false;
    		}

 
    		var options = {
    			url : "<%=basePath%>fileService/identityPic.do",
    			type : "post",
    			dataType : "json",
    			success : function(data) {
    				
    				$("#identityUrl").attr("src", data.pic);//回显全路径
    				$("#identity").val(data.pic);//此处是把啊里全路径保存进实体对应URL
    				$("#picIdentityWarn").hide();
    			}
    		}
    		//异步上传
    		$("#orgAdd").ajaxSubmit(options);
    	}  
    	
    	//上传身份证正面照
    	function uploadIdCardPositivePic(file) {
    		
    		/* var f = document.getElementById("imageFile").files;  
    		var file_size =f[0].size;
    		var size = file_size / 1024;
    		if (size > 40) {
    			alert("上传的文件大小不能超过40KB！");
    			return false;
    		} */
    		
    		
    		//主流浏览器
			if(file.files && file.files[0]){
				var imgObj = $('<img class="imgshow" />');
				$('.upload_wrap_c').append(imgObj);
				var reader = new FileReader();
				console.log(reader);
				reader.onload = function(evt){
					imgObj.attr('src',evt.target.result);
				}
				reader.readAsDataURL(file.files[0]);
			}else{
				//ie浏览器
				file.select();
				file.blur();
				var src = document.selection.createRange().text;
				console.log(document.selection.createRange());
				console.log(src);
				var sFilter='progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src=\'' + src + '\')';
				var divObj = $('<div class="imgshow"></div>');
				divObj.css('filter',sFilter);
				$('.upload_wrap_c').append(divObj); 
			}
    		
    		
    		var filepath = $("input[name='idCardPositiveFile']").val();
    		var extStart = filepath.lastIndexOf(".");
    		var ext = filepath.substring(extStart, filepath.length).toUpperCase();
    		if (ext != ".BMP" && ext != ".PNG" && ext != ".GIF" && ext != ".JPG"
    				&& ext != ".JPEG") {
    			alert("图片限于bmp,png,gif,jpeg,jpg格式");
    			return false;
    		}

 
    		var options = {
    			url : "<%=basePath%>fileService/idCardPositive.do",
    			type : "post",
    			dataType : "json",
    			success : function(data) {
    				
    				$("#idCardPositiveUrl").attr("src", data.pic);//回显全路径
    				$("#idCardPositive").val(data.pic);//此处是把啊里全路径保存进实体对应URL
    				$("#idCardPositiveWarn").hide();
    			}
    		}
    		//异步上传
    		$("#orgAdd").ajaxSubmit(options);
    	}
    	
    	
    	
    	//上传身份证反面照
    	function uploadIdCardNegativePic(file) {
    		
    		/* var f = document.getElementById("imageFile").files;  
    		var file_size =f[0].size;
    		var size = file_size / 1024;
    		if (size > 40) {
    			alert("上传的文件大小不能超过40KB！");
    			return false;
    		} */
    		
    		//主流浏览器
			if(file.files && file.files[0]){
				var imgObj = $('<img class="imgshow" />');
				$('.upload_wrap_d').append(imgObj);
				var reader = new FileReader();
				console.log(reader);
				reader.onload = function(evt){
					imgObj.attr('src',evt.target.result);
				}
				reader.readAsDataURL(file.files[0]);
			}else{
				//ie浏览器
				console.log(file);
				file.select();
				file.blur();
				var src = document.selection.createRange().text;
				console.log(document.selection.createRange());
				console.log(src);
				var sFilter='progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src=\'' + src + '\')';
				var divObj = $('<div class="imgshow"></div>');
				divObj.css('filter',sFilter);
				$('.upload_wrap_d').append(divObj); 
			}
    		
    		
    		var filepath = $("input[name='idCardNegativeFile']").val();
    		var extStart = filepath.lastIndexOf(".");
    		var ext = filepath.substring(extStart, filepath.length).toUpperCase();
    		if (ext != ".BMP" && ext != ".PNG" && ext != ".GIF" && ext != ".JPG"
    				&& ext != ".JPEG") {
    			alert("图片限于bmp,png,gif,jpeg,jpg格式");
    			return false;
    		}

 
    		var options = {
    			url : "<%=basePath%>fileService/idCardNegative.do",
				type : "post",
				dataType : "json",
				success : function(data) {

					$("#idCardNegativeUrl").attr("src", data.pic);//回显全路径
					$("#idCardNegative").val(data.pic);//此处是把啊里全路径保存进实体对应URL
					$("#idCardNegativeWarn").hide();
				}
			}
			//异步上传
			$("#orgAdd").ajaxSubmit(options);
		}
	</script>
</body>
</html>